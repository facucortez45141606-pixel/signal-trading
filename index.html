<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analizador Visual de Se√±ales Exness</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0"></script>
  <style>
    body {
      background-color: #0f172a;
      color: #e2e8f0;
      font-family: "Segoe UI", Arial, sans-serif;
      text-align: center;
      padding: 40px;
    }
    h1 {
      color: #38bdf8;
    }
    input {
      margin-top: 20px;
    }
    button {
      background: #38bdf8;
      border: none;
      color: black;
      padding: 10px 25px;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
    }
    button:hover {
      background: #0ea5e9;
    }
    #result {
      font-size: 1.6em;
      margin-top: 30px;
      padding: 20px;
      border-radius: 12px;
      display: inline-block;
    }
    .buy {
      background-color: #16a34a;
      color: white;
    }
    .sell {
      background-color: #dc2626;
      color: white;
    }
    .hold {
      background-color: #facc15;
      color: black;
    }
    img {
      margin-top: 25px;
      max-width: 90%;
      border-radius: 10px;
      border: 2px solid #38bdf8;
    }
  </style>
</head>
<body>
  <h1>üìà Analizador Visual Exness</h1>
  <p>Sub√≠ una <b>imagen del gr√°fico</b> y el sistema te dir√° si conviene <b>comprar</b> o <b>vender</b>.</p>

  <input type="file" id="upload" accept="image/*" />
  <button onclick="analyzeImage()">üîç Analizar Imagen</button>
  <div id="result"></div>
  <img id="preview" src="" alt="" hidden />

  <script>
    async function analyzeImage() {
      const fileInput = document.getElementById("upload");
      const resultDiv = document.getElementById("result");
      const preview = document.getElementById("preview");

      const file = fileInput.files[0];
      if (!file) {
        resultDiv.innerHTML = "‚ö†Ô∏è Seleccion√° una imagen del gr√°fico.";
        return;
      }

      const reader = new FileReader();
      reader.onload = async function (e) {
        preview.src = e.target.result;
        preview.hidden = false;
        resultDiv.innerHTML = "Analizando imagen... ‚è≥";

        // Convertir imagen en tensor (baja resoluci√≥n para an√°lisis)
        const img = new Image();
        img.src = e.target.result;
        img.onload = async () => {
          const tensor = tf.browser.fromPixels(img).resizeNearestNeighbor([64, 64]).mean(2).expandDims(0).expandDims(-1).toFloat().div(255);

          // --- Simulaci√≥n de an√°lisis determinista (basado en contraste y direcci√≥n) ---
          const mean = (await tensor.mean().data())[0];
          const variance = (await tensor.var().data())[0];
          const score = mean * 10 - variance * 5;

          let decision = "HOLD";
          let cls = "hold";
          if (score > 1) {
            decision = "BUY";
            cls = "buy";
          } else if (score < -1) {
            decision = "SELL";
            cls = "sell";
          }

          resultDiv.className = cls;
          resultDiv.innerHTML = `<b>${decision}</b><br><small>Puntaje visual: ${score.toFixed(2)}</small>`;
        };
      };
      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>
