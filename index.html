<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Indicador Pro de Trading</title>
<style>
body {
  font-family: Arial;
  text-align: center;
  background: #0f172a;
  color: white;
  padding: 20px;
}
button {
  background: #22c55e;
  border: none;
  padding: 10px 20px;
  color: white;
  border-radius: 10px;
  margin: 10px;
}
.result {
  font-size: 1.5em;
  margin-top: 20px;
}
</style>
</head>
<body>
<h2>ðŸ“ˆ Analizador de SeÃ±ales de Trading</h2>
<p>Selecciona una criptomoneda para analizar su tendencia actual.</p>

<select id="symbol">
  <option value="BTCUSDT">Bitcoin (BTC/USDT)</option>
  <option value="ETHUSDT">Ethereum (ETH/USDT)</option>
  <option value="BNBUSDT">BNB (BNB/USDT)</option>
</select>
<br>
<button onclick="analyze()">Analizar Mercado</button>

<div class="result" id="result"></div>

<script>
async function analyze() {
  const symbol = document.getElementById("symbol").value;
  const res = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=1h&limit=100`);
  const data = await res.json();

  // Convertimos a precios de cierre
  const closes = data.map(c => parseFloat(c[4]));

  // Calcular RSI (14 periodos)
  function calcRSI(prices, period = 14) {
    let gains = 0, losses = 0;
    for (let i = 1; i <= period; i++) {
      const diff = prices[i] - prices[i - 1];
      if (diff >= 0) gains += diff;
      else losses -= diff;
    }
    let avgGain = gains / period;
    let avgLoss = losses / period;
    for (let i = period + 1; i < prices.length; i++) {
      const diff = prices[i] - prices[i - 1];
      if (diff >= 0) {
        avgGain = (avgGain * (period - 1) + diff) / period;
        avgLoss = (avgLoss * (period - 1)) / period;
      } else {
        avgGain = (avgGain * (period - 1)) / period;
        avgLoss = (avgLoss * (period - 1) - diff) / period;
      }
    }
    const rs = avgGain / (avgLoss || 1);
    return 100 - 100 / (1 + rs);
  }

  const rsi = calcRSI(closes);
  const smaShort = closes.slice(-7).reduce((a,b)=>a+b)/7;
  const smaLong = closes.slice(-25).reduce((a,b)=>a+b)/25;

  let signal = "";
  if (rsi < 30 && smaShort > smaLong) signal = "ðŸŸ¢ COMPRA (sobreventa + cruce alcista)";
  else if (rsi > 70 && smaShort < smaLong) signal = "ðŸ”´ VENTA (sobrecompra + cruce bajista)";
  else signal = "âšª NEUTRO (esperar confirmaciÃ³n)";

  document.getElementById("result").innerHTML = `
    <b>${symbol}</b><br>
    RSI: ${rsi.toFixed(2)}<br>
    SMA 7: ${smaShort.toFixed(2)}<br>
    SMA 25: ${smaLong.toFixed(2)}<br>
    <br><b>Resultado:</b> ${signal}
  `;
}
</script>
</body>
</html>
