<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trading Analyzer Pro (Android)</title>
  <style>
    body {
      background-color: #0f172a;
      color: #f1f5f9;
      font-family: "Segoe UI", Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    .card {
      background: #1e293b;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 0 15px rgba(0,0,0,0.4);
      max-width: 500px;
      margin: 30px auto;
    }
    button {
      background: #38bdf8;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      margin: 10px 5px;
      cursor: pointer;
      font-weight: bold;
      color: #fff;
    }
    button:hover { background: #0ea5e9; }
    select {
      background: #334155;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px;
      width: 80%;
      font-size: 15px;
    }
    #result { margin-top: 20px; font-size: 18px; }
    #progress {
      height: 10px;
      background: #334155;
      border-radius: 6px;
      overflow: hidden;
      margin-top: 10px;
    }
    #bar {
      height: 100%;
      width: 0%;
      background: #38bdf8;
      transition: width 0.2s ease;
    }
  </style>
</head>
<body>
  <h1>ü§ñ Trading Analyzer Pro</h1>
  <div class="card">
    <p>Sube una captura de tu gr√°fico (BTC, Forex, etc.)</p>
    <input type="file" id="imageInput" accept="image/*"><br><br>

    <label for="mode"><b>Modo de an√°lisis:</b></label><br>
    <select id="mode">
      <option value="agresivo">üî• Agresivo (1‚Äì3 min)</option>
      <option value="equilibrado" selected>‚öñÔ∏è Equilibrado (3‚Äì7 min)</option>
      <option value="conservador">üß† Conservador (7‚Äì15 min)</option>
    </select><br>

    <button onclick="analyzeChart()">Analizar (15 s)</button>
    <div id="progress"><div id="bar"></div></div>
    <div id="result"></div>
  </div>

  <canvas id="canvas" style="display:none;"></canvas>

  <script>
    async function analyzeChart() {
      const input = document.getElementById('imageInput');
      const result = document.getElementById('result');
      const bar = document.getElementById('bar');
      const mode = document.getElementById('mode').value;

      if (!input.files[0]) {
        result.innerHTML = "‚ö†Ô∏è Por favor, sube una imagen del gr√°fico.";
        return;
      }

      result.innerHTML = "‚è≥ Analizando imagen... (15 s)";
      bar.style.width = "0%";

      // Simula barra de progreso
      let progress = 0;
      const interval = setInterval(() => {
        progress += 1;
        bar.style.width = progress + "%";
        if (progress >= 100) clearInterval(interval);
      }, 150);

      const img = new Image();
      img.src = URL.createObjectURL(input.files[0]);

      img.onload = function() {
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = img.width;
        canvas.height = img.height;
        ctx.drawImage(img, 0, 0, img.width, img.height);

        const data = ctx.getImageData(0, 0, img.width, img.height).data;

        let red = 0, green = 0, gray = 0;
        for (let i = 0; i < data.length; i += 4) {
          const [r, g, b] = [data[i], data[i+1], data[i+2]];
          const avg = (r + g + b) / 3;
          if (r > g + 30 && r > b + 30) red++;
          else if (g > r + 30 && g > b + 30) green++;
          else if (avg > 40 && avg < 130) gray++;
        }

        setTimeout(() => {
          const total = red + green + gray;
          const pRed = (red / total) * 100;
          const pGreen = (green / total) * 100;

          let decision = "";
          let color = "";
          let duracion = "";

          // Ajustes seg√∫n modo
          let margen = mode === "agresivo" ? 3 : mode === "conservador" ? 8 : 5;

          if (pGreen > pRed + margen) {
            decision = "üìà COMPRA (BUY)";
            color = "#22c55e";
          } else if (pRed > pGreen + margen) {
            decision = "üìâ VENTA (SELL)";
            color = "#ef4444";
          } else {
            decision = "‚öñÔ∏è INTERMEDIO (ESPERAR)";
            color = "#eab308";
          }

          // Duraci√≥n seg√∫n modo
          if (mode === "agresivo") duracion = "1‚Äì3 min";
          else if (mode === "equilibrado") duracion = "3‚Äì7 min";
          else duracion = "7‚Äì15 min";

          result.innerHTML = `
            <p><b>Resultado del an√°lisis:</b></p>
            <p style="color:${color}; font-size:22px;">${decision}</p>
            <p>Duraci√≥n estimada: <b>${duracion}</b></p>
            <p>(Modo: ${mode.charAt(0).toUpperCase() + mode.slice(1)})</p>
          `;
        }, 16000);
      };
    }
  </script>
</body>
</html>
